!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports,require("@fr0st/ui"),require("@fr0st/query")):"function"==typeof define&&define.amd?define(["exports","@fr0st/ui","@fr0st/query"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).UI=t.UI||{},t.UI,t.fQuery)}(this,(function(t,i,e){"use strict";class s extends i.BaseComponent{constructor(t,i){super(t,i),this._options.step&&(this._stepLength=`${this._options.step}`.replace("d*.?/","").length),e.hasAttribute(this._node,"step")&&(this._options.step=e.getAttribute(this._node,"step")),e.hasAttribute(this._node,"min")&&(this._options.min=e.getAttribute(this._node,"min")),e.hasAttribute(this._node,"max")&&(this._options.max=e.getAttribute(this._node,"max")),null===this._options.max&&(this._options.max=this._options.stars),e.is(this._node,"[readonly]")&&(this._options.displayOnly=!0),this._render(),this._refresh(),this._options.displayOnly||this._events(),this._options.tooltip&&this._tooltipEvents(),this._refreshDisabled()}disable(){e.setAttribute(this._node,{disabled:!0}),this._refreshDisabled()}dispose(){this._tooltip&&(this._tooltip.dispose(),this._tooltip=null),e.remove(this._outerContainer),e.removeAttribute(this._node,"tabindex"),e.removeEvent(this._node,"focus.ui.starrating"),e.removeClass(this._node,this.constructor.classes.hide),this._outerContainer=null,this._container=null,this._filledContainer=null,super.dispose()}enable(){e.removeAttribute(this._node,"disabled"),this._refreshDisabled()}getValue(){const t=e.getValue(this._node);return""!==t?parseFloat(t):null}setValue(t){if(t=parseFloat(t),(t=this._clampValue(t))===this.getValue())return;const i=this._getPercent(t);e.setStyle(this._filledContainer,{width:`${i}%`}),this._setTooltipText(t),e.setValue(this._node,t),e.triggerEvent(this._node,"change.ui.starrating")}}s.defaults={size:"md",min:0,max:null,step:1,stars:5,tooltip:!0,tooltipText:t=>1===t?`${t} star`:`${t} stars`,animate:!0,displayOnly:!1},s.classes={animate:"starrating-animate",container:"starrating",disabled:"starrating-disabled",filled:"starrating-filled",hide:"visually-hidden",outline:"starrating-outline"},s.icons={filled:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2L9.19 8.62L2 9.24l5.45 4.73L5.82 21L12 17.27z" fill="currentColor"/></svg>',outline:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 15.39l-3.76 2.27l.99-4.28l-3.32-2.88l4.38-.37L12 6.09l1.71 4.04l4.38.37l-3.32 2.88l.99 4.28M22 9.24l-7.19-.61L12 2L9.19 8.63L2 9.24l5.45 4.73L5.82 21L12 17.27L18.18 21l-1.64-7.03L22 9.24z" fill="currentColor"/></svg>'};const n=s.prototype;n._clampValue=function(t){return this._options.step&&(t=(t/=this._options.step)<1?Math.round(t):Math.ceil(t),t=(t*=this._options.step).toFixed(this._stepLength)),e._clamp(t,this._options.min,this._options.max)},n._events=function(){e.addEvent(this._node,"focus.ui.starrating",(t=>{e.focus(this._container)})),e.addEvent(this._container,"click.ui.starrating",(t=>{const i=e.percentX(this._container,t.pageX,{offset:!0}),s=this._getValue(i);this.setValue(s)})),e.addEvent(this._container,"mousemove.ui.starrating",e.debounce((t=>{const i=e.percentX(this._container,t.pageX,{offset:!0}),s=this._getValue(i),n=this._getPercent(s);this._options.animate&&e.setStyle(this._filledContainer,{transition:"none"}),e.setStyle(this._filledContainer,{width:`${n}%`}),this._options.animate&&(e.rect(this._filledContainer),e.setStyle(this._filledContainer,{transition:""})),this._setTooltipText(s)})),{passive:!0}),e.addEvent(this._container,"mouseleave.ui.starrating",(t=>{this._refresh()})),e.addEvent(this._container,"keydown.ui.starrating",(t=>{let i=this.getValue();switch(null===i&&(i=this._options.min),t.code){case"ArrowLeft":i=Math.max(this._options.min,i-this._options.step);break;case"ArrowRight":i=Math.min(this._options.max,i+this._options.step);break;default:return}this.setValue(i)}))},n._getPercent=function(t){return 100*e._inverseLerp(0,this._options.stars,t)},n._getValue=function(t){const i=e._lerp(0,this._options.stars,t/100);return this._clampValue(i)},n._refresh=function(){const t=this.getValue(),i=this._getPercent(t);e.setStyle(this._filledContainer,{width:`${i}%`}),this._setTooltipText(t)},n._refreshDisabled=function(){e.is(this._node,":disabled")?e.addClass(this._container,this.constructor.classes.disabled):e.removeClass(this._container,this.constructor.classes.disabled)},n._render=function(){this._outerContainer=e.create("div"),this._options.animate&&e.addClass(this._outerContainer,this.constructor.classes.animate),this._container=e.create("div",{class:[this.constructor.classes.container,`starrating-${this._options.size}`],attributes:{tabindex:0}});const t=[],s=[];for(let i=0;i<this._options.stars;i++)t.push(this.constructor.icons.outline),s.push(this.constructor.icons.filled);const n=e.create("div",{class:this.constructor.classes.outline,html:t.join("")});this._filledContainer=e.create("div",{class:this.constructor.classes.filled,html:s.join("")}),e.append(this._container,n),e.append(this._container,this._filledContainer),e.append(this._outerContainer,this._container),e.addClass(this._node,this.constructor.classes.hide),e.setAttribute(this._node,{tabindex:-1}),e.before(this._node,this._outerContainer),this._options.tooltip&&(this._tooltip=i.Tooltip.init(this._container,{appendTo:"body",trigger:"",placement:"top"}))},n._tooltipEvents=function(){e.addEvent(this._container,"mouseenter.ui.starrating",(t=>{this._tooltip._stop(),this._tooltip.show()})),e.addEvent(this._container,"mouseleave.ui.starrating",(t=>{this._tooltip._stop(),this._tooltip.hide()}))},n._setTooltipText=function(t){if(!this._tooltip)return;null===t&&(t=this._options.min);const i=this._options.tooltipText.bind(this)(t);e.setDataset(this._container,{uiTitle:i}),this._tooltip.refresh(),this._tooltip.update()},i.initComponent("starrating",s),t.StarRating=s}));
!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e:e(t)}(window,(function(t){"use strict";if(!t)throw new Error("FrostUI-StarRating requires a Window.");if(!("UI"in t))throw new Error("FrostUI-StarRating requires FrostUI.");const e=t.Core,s=t.DOM,i=t.dom,n=t.UI;class o extends n.BaseComponent{constructor(t,e){super(t,e),this._settings.step&&(this._stepLength=`${this._settings.step}`.replace("d*.?/","").length),i.hasAttribute(this._node,"step")&&(this._settings.step=i.getAttribute(this._node,"step")),i.hasAttribute(this._node,"min")&&(this._settings.min=i.getAttribute(this._node,"min")),i.hasAttribute(this._node,"max")&&(this._settings.max=i.getAttribute(this._node,"max")),null===this._settings.max&&(this._settings.max=this._settings.stars),i.is(this._node,"[readonly]")&&(this._settings.displayOnly=!0),this._render(),this._refresh(),this._settings.displayOnly||this._events(),this._settings.tooltip&&this._tooltipEvents(),this._refreshDisabled()}disable(){return i.setAttribute(this._node,"disabled",!0),this._refreshDisabled(),this}dispose(){this._tooltip&&(this._tooltip.dispose(),this._tooltip=null),i.remove(this._outerContainer),i.removeAttribute(this._node,"tabindex"),i.removeEvent(this._node,"focus.ui.slider"),i.removeClass(this._node,this.constructor.classes.hide),this._outerContainer=null,this._container=null,this._filledContainer=null,super.dispose()}enable(){return i.removeAttribute(this._node,"disabled"),this._refreshDisabled(),this}getValue(){const t=i.getValue(this._node);return t?parseFloat(t):null}setValue(t){if((t=parseFloat(t))!==this.getValue())return i.setValue(this._node,t),this._refresh(),i.triggerEvent(this._node,"change.ui.starrating"),this}}Object.assign(o.prototype,{_events(){i.addEvent(this._node,"focus.ui.slider",(t=>{i.focus(this._container)})),i.addEvent(this._container,"click.ui.starrating",(t=>{const e=i.percentX(this._container,t.pageX,!0),s=this._getValue(e);this.setValue(s)})),i.addEvent(this._container,"mousemove.ui.starrating",s.debounce((t=>{const e=i.percentX(this._container,t.pageX,!0),s=this._getValue(e),n=this._getPercent(s);i.setStyle(this._filledContainer,"width",`${n}%`),this._setTooltipText(s)}))),i.addEvent(this._container,"mouseleave.ui.starrating",(t=>{this._refresh()})),i.addEvent(this._container,"keydown.ui.starrating",(t=>{let e=this.getValue();switch(null===e&&(e=this._settings.min),t.code){case"ArrowLeft":e=Math.max(this._settings.min,e-this._settings.step);break;case"ArrowRight":e=Math.min(this._settings.max,e+this._settings.step);break;default:return}this.setValue(e)}))},_tooltipEvents(){i.addEvent(this._container,"mouseenter.ui.starrating",(t=>{this._tooltip._stop(),this._tooltip.show()})),i.addEvent(this._container,"mouseleave.ui.starrating",(t=>{this._tooltip._stop(),this._tooltip.hide()}))}}),Object.assign(o.prototype,{_getPercent(t){return 100*e.inverseLerp(0,this._settings.stars,t)},_getValue(t){let s=e.lerp(0,this._settings.stars,t/100);return this._settings.step&&(s/=this._settings.step,s=s<1?Math.round(s):Math.ceil(s),s*=this._settings.step,s=s.toFixed(this._stepLength)),e.clamp(s,this._settings.min,this._settings.max)},_refreshDisabled(){i.is(this._node,":disabled")?i.addClass(this._container,this.constructor.classes.disabled):i.removeClass(this._container,this.constructor.classes.disabled)},_setTooltipText(t){if(!this._tooltip)return;null===t&&(t=this._settings.min);const e=this._settings.tooltipText.bind(this)(t);i.setDataset(this._container,"uiTitle",e),this._tooltip.refresh(),this._tooltip.update()}}),Object.assign(o.prototype,{_refresh(){const t=this.getValue(),e=this._getPercent(t);i.setStyle(this._filledContainer,"width",`${e}%`),this._setTooltipText(t)},_render(){this._outerContainer=i.create("div"),this._settings.animate&&i.addClass(this._outerContainer,this.constructor.classes.animate),this._container=i.create("div",{class:[this.constructor.classes.container,`starrating-${this._settings.size}`],attributes:{tabindex:0}});const t=[],e=[];for(let s=0;s<this._settings.stars;s++)t.push(this.constructor.icons.outline),e.push(this.constructor.icons.filled);const s=i.create("div",{class:this.constructor.classes.outline,html:t.join("")});this._filledContainer=i.create("div",{class:this.constructor.classes.filled,html:e.join("")}),i.append(this._container,s),i.append(this._container,this._filledContainer),i.append(this._outerContainer,this._container),i.addClass(this._node,this.constructor.classes.hide),i.setAttribute(this._node,"tabindex","-1"),i.before(this._node,this._outerContainer),this._settings.tooltip&&(this._tooltip=n.Tooltip.init(this._container,{appendTo:"body",trigger:"",placement:"top"}))}}),o.defaults={size:"md",min:0,max:null,step:1,stars:5,tooltip:!0,tooltipText:t=>1===t?`${t} star`:`${t} stars`,animate:!0,displayOnly:!1},o.classes={animate:"starrating-animate",container:"position-relative d-inline-block overflow-hidden lh-1 text-nowrap starrating",disabled:"starrating-disabled",filled:"position-absolute top-0 overflow-hidden starrating-filled",hide:"visually-hidden",outline:"starrating-outline"},o.icons={filled:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2L9.19 8.62L2 9.24l5.45 4.73L5.82 21L12 17.27z" fill="currentColor"/></svg>',outline:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 15.39l-3.76 2.27l.99-4.28l-3.32-2.88l4.38-.37L12 6.09l1.71 4.04l4.38.37l-3.32 2.88l.99 4.28M22 9.24l-7.19-.61L12 2L9.19 8.63L2 9.24l5.45 4.73L5.82 21L12 17.27L18.18 21l-1.64-7.03L22 9.24z" fill="currentColor"/></svg>'},n.initComponent("starrating",o),n.StarRating=o}));
{"version":3,"names":["StarRating","BaseComponent","constructor","node","options","super","this","_options","step","_stepLength","replace","length","$","hasAttribute","_node","getAttribute","min","max","stars","is","displayOnly","_render","_refresh","_events","tooltip","_tooltipEvents","_refreshDisabled","disable","setAttribute","disabled","dispose","_tooltip","remove","_outerContainer","removeAttribute","removeEvent","removeClass","classes","hide","_container","_filledContainer","enable","getValue","value","parseFloat","setValue","_clampValue","percent","_getPercent","setStyle","width","_setTooltipText","triggerEvent","defaults","size","tooltipText","rating","animate","container","filled","outline","icons","proto","prototype","Math","round","ceil","toFixed","_clamp","addEvent","_","focus","e","percentX","pageX","offset","_getValue","debounce","transition","rect","passive","code","_inverseLerp","_lerp","addClass","create","class","attributes","tabindex","i","push","outlineContainer","html","join","append","before","Tooltip","init","appendTo","trigger","placement","_stop","show","ratingText","bind","setDataset","uiTitle","refresh","update","initComponent"],"sources":["../src/js/star-rating.js","../src/js/index.js","../src/js/prototype/helpers.js","../src/js/prototype/events.js","../src/js/prototype/render.js"],"sourcesContent":["import $ from '@fr0st/query';\nimport { BaseComponent } from '@fr0st/ui';\n\n/**\n * StarRating Class\n * @class\n */\nexport default class StarRating extends BaseComponent {\n    /**\n     * New StarRating constructor.\n     * @param {HTMLElement} node The input node.\n     * @param {object} [options] The options to create the StarRating with.\n     */\n    constructor(node, options) {\n        super(node, options);\n\n        if (this._options.step) {\n            this._stepLength = `${this._options.step}`.replace('\\d*\\.?/', '').length;\n        }\n\n        if ($.hasAttribute(this._node, 'step')) {\n            this._options.step = $.getAttribute(this._node, 'step');\n        }\n\n        if ($.hasAttribute(this._node, 'min')) {\n            this._options.min = $.getAttribute(this._node, 'min');\n        }\n\n        if ($.hasAttribute(this._node, 'max')) {\n            this._options.max = $.getAttribute(this._node, 'max');\n        }\n\n        if (this._options.max === null) {\n            this._options.max = this._options.stars;\n        }\n\n        if ($.is(this._node, '[readonly]')) {\n            this._options.displayOnly = true;\n        }\n\n        this._render();\n        this._refresh();\n\n        if (!this._options.displayOnly) {\n            this._events();\n        }\n\n        if (this._options.tooltip) {\n            this._tooltipEvents();\n        }\n\n        this._refreshDisabled();\n    }\n\n    /**\n     * Disable the StarRating.\n     */\n    disable() {\n        $.setAttribute(this._node, { disabled: true });\n        this._refreshDisabled();\n    }\n\n    /**\n     * Dispose the StarRating.\n     */\n    dispose() {\n        if (this._tooltip) {\n            this._tooltip.dispose();\n            this._tooltip = null;\n        }\n\n        $.remove(this._outerContainer);\n        $.removeAttribute(this._node, 'tabindex');\n        $.removeEvent(this._node, 'focus.ui.starrating');\n        $.removeClass(this._node, this.constructor.classes.hide);\n\n        this._outerContainer = null;\n        this._container = null;\n        this._filledContainer = null;\n\n        super.dispose();\n    }\n\n    /**\n     * Enable the StarRating.\n     */\n    enable() {\n        $.removeAttribute(this._node, 'disabled');\n        this._refreshDisabled();\n    }\n\n    /**\n     * Get the current value.\n     * @return {number} The current value.\n     */\n    getValue() {\n        const value = $.getValue(this._node);\n\n        return value !== '' ?\n            parseFloat(value) :\n            null;\n    }\n\n    /**\n     * Set the current value.\n     * @param {number} value The value to set.\n     */\n    setValue(value) {\n        value = parseFloat(value);\n        value = this._clampValue(value);\n\n        if (value === this.getValue()) {\n            return;\n        }\n\n        const percent = this._getPercent(value);\n\n        $.setStyle(this._filledContainer, { width: `${percent}%` });\n\n        this._setTooltipText(value);\n\n        $.setValue(this._node, value);\n        $.triggerEvent(this._node, 'change.ui.starrating');\n    }\n}\n","import { initComponent } from '@fr0st/ui';\nimport StarRating from './star-rating.js';\nimport { _events, _tooltipEvents } from './prototype/events.js';\nimport { _clampValue, _getPercent, _getValue, _refresh, _refreshDisabled, _setTooltipText } from './prototype/helpers.js';\nimport { _render } from './prototype/render.js';\n\n// StarRating default options\nStarRating.defaults = {\n    size: 'md',\n    min: 0,\n    max: null,\n    step: 1,\n    stars: 5,\n    tooltip: true,\n    tooltipText: (rating) => rating === 1 ?\n        `${rating} star` :\n        `${rating} stars`,\n    animate: true,\n    displayOnly: false,\n};\n\n// StarRating classes\nStarRating.classes = {\n    animate: 'starrating-animate',\n    container: 'starrating',\n    disabled: 'starrating-disabled',\n    filled: 'starrating-filled',\n    hide: 'visually-hidden',\n    outline: 'starrating-outline',\n};\n\n// StarRating icons\nStarRating.icons = {\n    filled: '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\" focusable=\"false\" width=\"1em\" height=\"1em\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"0 0 24 24\"><path d=\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2L9.19 8.62L2 9.24l5.45 4.73L5.82 21L12 17.27z\" fill=\"currentColor\"/></svg>',\n    outline: '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\" focusable=\"false\" width=\"1em\" height=\"1em\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"0 0 24 24\"><path d=\"M12 15.39l-3.76 2.27l.99-4.28l-3.32-2.88l4.38-.37L12 6.09l1.71 4.04l4.38.37l-3.32 2.88l.99 4.28M22 9.24l-7.19-.61L12 2L9.19 8.63L2 9.24l5.45 4.73L5.82 21L12 17.27L18.18 21l-1.64-7.03L22 9.24z\" fill=\"currentColor\"/></svg>',\n};\n\n// StarRating prototype\nconst proto = StarRating.prototype;\n\nproto._clampValue = _clampValue;\nproto._events = _events;\nproto._getPercent = _getPercent;\nproto._getValue = _getValue;\nproto._refresh = _refresh;\nproto._refreshDisabled = _refreshDisabled;\nproto._render = _render;\nproto._tooltipEvents = _tooltipEvents;\nproto._setTooltipText = _setTooltipText;\n\n// StarRating init\ninitComponent('starrating', StarRating);\n\nexport default StarRating;\n","import $ from '@fr0st/query';\n\n/**\n * Clamp a value to a step-size, and between a min and max value.\n * @param {number} value The value to clamp.\n * @returns The clamped value.\n */\nexport function _clampValue(value) {\n    if (this._options.step) {\n        value /= this._options.step;\n        value = value < 1 ? Math.round(value) : Math.ceil(value);\n        value *= this._options.step;\n        value = value.toFixed(this._stepLength);\n    }\n\n    return $._clamp(value, this._options.min, this._options.max);\n};\n\n/**\n * Get the percent from a value.\n * @param {number} value The value.\n * @return {number} The percent.\n */\nexport function _getPercent(value) {\n    return $._inverseLerp(0, this._options.stars, value) * 100;\n};\n\n/**\n * Get the value from an X percent.\n * @param {number} percentX The X percent.\n * @return {number} The value.\n */\nexport function _getValue(percentX) {\n    const value = $._lerp(0, this._options.stars, percentX / 100);\n\n    return this._clampValue(value);\n};\n\n/**\n * Refresh the star rating.\n */\nexport function _refresh() {\n    const value = this.getValue();\n    const percent = this._getPercent(value);\n\n    $.setStyle(this._filledContainer, { width: `${percent}%` });\n\n    this._setTooltipText(value);\n};\n\n/**\n * Refresh the disabled styling.\n */\nexport function _refreshDisabled() {\n    if ($.is(this._node, ':disabled')) {\n        $.addClass(this._container, this.constructor.classes.disabled);\n    } else {\n        $.removeClass(this._container, this.constructor.classes.disabled);\n    }\n};\n\n/**\n * Set the tooltip text.\n * @param {number} value The value.\n */\nexport function _setTooltipText(value) {\n    if (!this._tooltip) {\n        return;\n    }\n\n    if (value === null) {\n        value = this._options.min;\n    }\n\n    const ratingText = this._options.tooltipText.bind(this)(value);\n    $.setDataset(this._container, { uiTitle: ratingText });\n\n    this._tooltip.refresh();\n    this._tooltip.update();\n};\n","import $ from '@fr0st/query';\n\n/**\n * Attach events for the StarRating.\n */\nexport function _events() {\n    $.addEvent(this._node, 'focus.ui.starrating', (_) => {\n        $.focus(this._container);\n    });\n\n    $.addEvent(this._container, 'click.ui.starrating', (e) => {\n        const percentX = $.percentX(this._container, e.pageX, { offset: true });\n        const value = this._getValue(percentX);\n\n        this.setValue(value);\n    });\n\n    $.addEvent(this._container, 'mousemove.ui.starrating', $.debounce((e) => {\n        const percentX = $.percentX(this._container, e.pageX, { offset: true });\n        const value = this._getValue(percentX);\n        const percent = this._getPercent(value);\n\n        if (this._options.animate) {\n            $.setStyle(this._filledContainer, { transition: 'none' });\n        }\n\n        $.setStyle(this._filledContainer, { width: `${percent}%` });\n\n        if (this._options.animate) {\n            // force redraw\n            $.rect(this._filledContainer);\n            $.setStyle(this._filledContainer, { transition: '' });\n        }\n\n        this._setTooltipText(value);\n    }), { passive: true });\n\n    $.addEvent(this._container, 'mouseleave.ui.starrating', (_) => {\n        this._refresh();\n    });\n\n    $.addEvent(this._container, 'keydown.ui.starrating', (e) => {\n        let value = this.getValue();\n\n        if (value === null) {\n            value = this._options.min;\n        }\n\n        switch (e.code) {\n            case 'ArrowLeft':\n                value = Math.max(this._options.min, value - this._options.step);\n                break;\n            case 'ArrowRight':\n                value = Math.min(this._options.max, value + this._options.step);\n                break;\n            default:\n                return;\n        }\n\n        this.setValue(value);\n    });\n};\n\n/**\n * Attach events for the StarRating tooltip.\n */\nexport function _tooltipEvents() {\n    $.addEvent(this._container, 'mouseenter.ui.starrating', (_) => {\n        this._tooltip._stop();\n        this._tooltip.show();\n    });\n\n    $.addEvent(this._container, 'mouseleave.ui.starrating', (_) => {\n        this._tooltip._stop();\n        this._tooltip.hide();\n    });\n};\n","import $ from '@fr0st/query';\nimport { Tooltip } from '@fr0st/ui';\n\n/**\n * Render the star rating.\n */\nexport function _render() {\n    this._outerContainer = $.create('div');\n\n    if (this._options.animate) {\n        $.addClass(this._outerContainer, this.constructor.classes.animate);\n    }\n\n    this._container = $.create('div', {\n        class: [this.constructor.classes.container, `starrating-${this._options.size}`],\n        attributes: {\n            tabindex: 0,\n        },\n    });\n\n    const outline = [];\n    const filled = [];\n    for (let i = 0; i < this._options.stars; i++) {\n        outline.push(this.constructor.icons.outline);\n        filled.push(this.constructor.icons.filled);\n    }\n\n    const outlineContainer = $.create('div', {\n        class: this.constructor.classes.outline,\n        html: outline.join(''),\n    });\n\n    this._filledContainer = $.create('div', {\n        class: this.constructor.classes.filled,\n        html: filled.join(''),\n    });\n\n    $.append(this._container, outlineContainer);\n    $.append(this._container, this._filledContainer);\n    $.append(this._outerContainer, this._container);\n\n    // hide the input node\n    $.addClass(this._node, this.constructor.classes.hide);\n    $.setAttribute(this._node, { tabindex: -1 });\n\n    $.before(this._node, this._outerContainer);\n\n    if (this._options.tooltip) {\n        this._tooltip = Tooltip.init(this._container, {\n            appendTo: 'body',\n            trigger: '',\n            placement: 'top',\n        });\n    }\n};\n"],"mappings":"0UAOe,MAAMA,UAAmBC,gBAMpCC,YAAYC,EAAMC,GACdC,MAAMF,EAAMC,GAERE,KAAKC,SAASC,OACdF,KAAKG,YAAc,GAAGH,KAAKC,SAASC,OAAOE,QAAQ,QAAW,IAAIC,QAGlEC,EAAEC,aAAaP,KAAKQ,MAAO,UAC3BR,KAAKC,SAASC,KAAOI,EAAEG,aAAaT,KAAKQ,MAAO,SAGhDF,EAAEC,aAAaP,KAAKQ,MAAO,SAC3BR,KAAKC,SAASS,IAAMJ,EAAEG,aAAaT,KAAKQ,MAAO,QAG/CF,EAAEC,aAAaP,KAAKQ,MAAO,SAC3BR,KAAKC,SAASU,IAAML,EAAEG,aAAaT,KAAKQ,MAAO,QAGzB,OAAtBR,KAAKC,SAASU,MACdX,KAAKC,SAASU,IAAMX,KAAKC,SAASW,OAGlCN,EAAEO,GAAGb,KAAKQ,MAAO,gBACjBR,KAAKC,SAASa,aAAc,GAGhCd,KAAKe,UACLf,KAAKgB,WAEAhB,KAAKC,SAASa,aACfd,KAAKiB,UAGLjB,KAAKC,SAASiB,SACdlB,KAAKmB,iBAGTnB,KAAKoB,kBACb,CAKIC,UACIf,EAAEgB,aAAatB,KAAKQ,MAAO,CAAEe,UAAU,IACvCvB,KAAKoB,kBACb,CAKII,UACQxB,KAAKyB,WACLzB,KAAKyB,SAASD,UACdxB,KAAKyB,SAAW,MAGpBnB,EAAEoB,OAAO1B,KAAK2B,iBACdrB,EAAEsB,gBAAgB5B,KAAKQ,MAAO,YAC9BF,EAAEuB,YAAY7B,KAAKQ,MAAO,uBAC1BF,EAAEwB,YAAY9B,KAAKQ,MAAOR,KAAKJ,YAAYmC,QAAQC,MAEnDhC,KAAK2B,gBAAkB,KACvB3B,KAAKiC,WAAa,KAClBjC,KAAKkC,iBAAmB,KAExBnC,MAAMyB,SACd,CAKIW,SACI7B,EAAEsB,gBAAgB5B,KAAKQ,MAAO,YAC9BR,KAAKoB,kBACb,CAMIgB,WACI,MAAMC,EAAQ/B,EAAE8B,SAASpC,KAAKQ,OAE9B,MAAiB,KAAV6B,EACHC,WAAWD,GACX,IACZ,CAMIE,SAASF,GAIL,GAHAA,EAAQC,WAAWD,IACnBA,EAAQrC,KAAKwC,YAAYH,MAEXrC,KAAKoC,WACf,OAGJ,MAAMK,EAAUzC,KAAK0C,YAAYL,GAEjC/B,EAAEqC,SAAS3C,KAAKkC,iBAAkB,CAAEU,MAAO,GAAGH,OAE9CzC,KAAK6C,gBAAgBR,GAErB/B,EAAEiC,SAASvC,KAAKQ,MAAO6B,GACvB/B,EAAEwC,aAAa9C,KAAKQ,MAAO,uBACnC,ECpHAd,EAAWqD,SAAW,CAClBC,KAAM,KACNtC,IAAK,EACLC,IAAK,KACLT,KAAM,EACNU,MAAO,EACPM,SAAS,EACT+B,YAAcC,GAAsB,IAAXA,EACrB,GAAGA,SACH,GAAGA,UACPC,SAAS,EACTrC,aAAa,GAIjBpB,EAAWqC,QAAU,CACjBoB,QAAS,qBACTC,UAAW,aACX7B,SAAU,sBACV8B,OAAQ,oBACRrB,KAAM,kBACNsB,QAAS,sBAIb5D,EAAW6D,MAAQ,CACfF,OAAQ,mVACRC,QAAS,kbAIb,MAAME,EAAQ9D,EAAW+D,UAEzBD,EAAMhB,YCjCC,SAAqBH,GAQxB,OAPIrC,KAAKC,SAASC,OAEdmC,GADAA,GAASrC,KAAKC,SAASC,MACP,EAAIwD,KAAKC,MAAMtB,GAASqB,KAAKE,KAAKvB,GAElDA,GADAA,GAASrC,KAAKC,SAASC,MACT2D,QAAQ7D,KAAKG,cAGxBG,EAAEwD,OAAOzB,EAAOrC,KAAKC,SAASS,IAAKV,KAAKC,SAASU,IAC5D,EDyBA6C,EAAMvC,QEpCC,WACHX,EAAEyD,SAAS/D,KAAKQ,MAAO,uBAAwBwD,IAC3C1D,EAAE2D,MAAMjE,KAAKiC,WAAW,IAG5B3B,EAAEyD,SAAS/D,KAAKiC,WAAY,uBAAwBiC,IAChD,MAAMC,EAAW7D,EAAE6D,SAASnE,KAAKiC,WAAYiC,EAAEE,MAAO,CAAEC,QAAQ,IAC1DhC,EAAQrC,KAAKsE,UAAUH,GAE7BnE,KAAKuC,SAASF,EAAM,IAGxB/B,EAAEyD,SAAS/D,KAAKiC,WAAY,0BAA2B3B,EAAEiE,UAAUL,IAC/D,MAAMC,EAAW7D,EAAE6D,SAASnE,KAAKiC,WAAYiC,EAAEE,MAAO,CAAEC,QAAQ,IAC1DhC,EAAQrC,KAAKsE,UAAUH,GACvB1B,EAAUzC,KAAK0C,YAAYL,GAE7BrC,KAAKC,SAASkD,SACd7C,EAAEqC,SAAS3C,KAAKkC,iBAAkB,CAAEsC,WAAY,SAGpDlE,EAAEqC,SAAS3C,KAAKkC,iBAAkB,CAAEU,MAAO,GAAGH,OAE1CzC,KAAKC,SAASkD,UAEd7C,EAAEmE,KAAKzE,KAAKkC,kBACZ5B,EAAEqC,SAAS3C,KAAKkC,iBAAkB,CAAEsC,WAAY,MAGpDxE,KAAK6C,gBAAgBR,EAAM,IAC3B,CAAEqC,SAAS,IAEfpE,EAAEyD,SAAS/D,KAAKiC,WAAY,4BAA6B+B,IACrDhE,KAAKgB,UAAU,IAGnBV,EAAEyD,SAAS/D,KAAKiC,WAAY,yBAA0BiC,IAClD,IAAI7B,EAAQrC,KAAKoC,WAMjB,OAJc,OAAVC,IACAA,EAAQrC,KAAKC,SAASS,KAGlBwD,EAAES,MACN,IAAK,YACDtC,EAAQqB,KAAK/C,IAAIX,KAAKC,SAASS,IAAK2B,EAAQrC,KAAKC,SAASC,MAC1D,MACJ,IAAK,aACDmC,EAAQqB,KAAKhD,IAAIV,KAAKC,SAASU,IAAK0B,EAAQrC,KAAKC,SAASC,MAC1D,MACJ,QACI,OAGRF,KAAKuC,SAASF,EAAM,GAE5B,EFnBAmB,EAAMd,YCnBC,SAAqBL,GACxB,OAAuD,IAAhD/B,EAAEsE,aAAa,EAAG5E,KAAKC,SAASW,MAAOyB,EAClD,EDkBAmB,EAAMc,UCXC,SAAmBH,GACtB,MAAM9B,EAAQ/B,EAAEuE,MAAM,EAAG7E,KAAKC,SAASW,MAAOuD,EAAW,KAEzD,OAAOnE,KAAKwC,YAAYH,EAC5B,EDQAmB,EAAMxC,SCHC,WACH,MAAMqB,EAAQrC,KAAKoC,WACbK,EAAUzC,KAAK0C,YAAYL,GAEjC/B,EAAEqC,SAAS3C,KAAKkC,iBAAkB,CAAEU,MAAO,GAAGH,OAE9CzC,KAAK6C,gBAAgBR,EACzB,EDHAmB,EAAMpC,iBCQC,WACCd,EAAEO,GAAGb,KAAKQ,MAAO,aACjBF,EAAEwE,SAAS9E,KAAKiC,WAAYjC,KAAKJ,YAAYmC,QAAQR,UAErDjB,EAAEwB,YAAY9B,KAAKiC,WAAYjC,KAAKJ,YAAYmC,QAAQR,SAEhE,EDbAiC,EAAMzC,QGxCC,WACHf,KAAK2B,gBAAkBrB,EAAEyE,OAAO,OAE5B/E,KAAKC,SAASkD,SACd7C,EAAEwE,SAAS9E,KAAK2B,gBAAiB3B,KAAKJ,YAAYmC,QAAQoB,SAG9DnD,KAAKiC,WAAa3B,EAAEyE,OAAO,MAAO,CAC9BC,MAAO,CAAChF,KAAKJ,YAAYmC,QAAQqB,UAAW,cAAcpD,KAAKC,SAAS+C,QACxEiC,WAAY,CACRC,SAAU,KAIlB,MAAM5B,EAAU,GACVD,EAAS,GACf,IAAK,IAAI8B,EAAI,EAAGA,EAAInF,KAAKC,SAASW,MAAOuE,IACrC7B,EAAQ8B,KAAKpF,KAAKJ,YAAY2D,MAAMD,SACpCD,EAAO+B,KAAKpF,KAAKJ,YAAY2D,MAAMF,QAGvC,MAAMgC,EAAmB/E,EAAEyE,OAAO,MAAO,CACrCC,MAAOhF,KAAKJ,YAAYmC,QAAQuB,QAChCgC,KAAMhC,EAAQiC,KAAK,MAGvBvF,KAAKkC,iBAAmB5B,EAAEyE,OAAO,MAAO,CACpCC,MAAOhF,KAAKJ,YAAYmC,QAAQsB,OAChCiC,KAAMjC,EAAOkC,KAAK,MAGtBjF,EAAEkF,OAAOxF,KAAKiC,WAAYoD,GAC1B/E,EAAEkF,OAAOxF,KAAKiC,WAAYjC,KAAKkC,kBAC/B5B,EAAEkF,OAAOxF,KAAK2B,gBAAiB3B,KAAKiC,YAGpC3B,EAAEwE,SAAS9E,KAAKQ,MAAOR,KAAKJ,YAAYmC,QAAQC,MAChD1B,EAAEgB,aAAatB,KAAKQ,MAAO,CAAE0E,UAAW,IAExC5E,EAAEmF,OAAOzF,KAAKQ,MAAOR,KAAK2B,iBAEtB3B,KAAKC,SAASiB,UACdlB,KAAKyB,SAAWiE,UAAQC,KAAK3F,KAAKiC,WAAY,CAC1C2D,SAAU,OACVC,QAAS,GACTC,UAAW,QAGvB,EHPAtC,EAAMrC,eEmBC,WACHb,EAAEyD,SAAS/D,KAAKiC,WAAY,4BAA6B+B,IACrDhE,KAAKyB,SAASsE,QACd/F,KAAKyB,SAASuE,MAAM,IAGxB1F,EAAEyD,SAAS/D,KAAKiC,WAAY,4BAA6B+B,IACrDhE,KAAKyB,SAASsE,QACd/F,KAAKyB,SAASO,MAAM,GAE5B,EF5BAwB,EAAMX,gBCiBC,SAAyBR,GAC5B,IAAKrC,KAAKyB,SACN,OAGU,OAAVY,IACAA,EAAQrC,KAAKC,SAASS,KAG1B,MAAMuF,EAAajG,KAAKC,SAASgD,YAAYiD,KAAKlG,KAA/BA,CAAqCqC,GACxD/B,EAAE6F,WAAWnG,KAAKiC,WAAY,CAAEmE,QAASH,IAEzCjG,KAAKyB,SAAS4E,UACdrG,KAAKyB,SAAS6E,QAClB,ED5BAC,gBAAc,aAAc7G,G"}